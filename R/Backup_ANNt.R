#'Backup_ANNt
#'Generate backup of the role
#'@param () No require parameters
#'@examples
#'Backup_ANNt()
#'@export
Backup_ANNt <- function(){
  library(stringr)
  Backup = 'Backup'
  Readme_ANNt = as.data.frame(matrix(nrow=12,ncol=1500))
  nomes=c('Inputs','Values')
  colnames(Readme_ANNt[1:length(nomes)])=nomes
  Inputs = c('Tickers',
             'RM',
             'Initial_Date',
             'Final_Date',
             'Initial_Date_Training',
             'Final_Date_Training',
             'Initial_Date_Testing',
             'Final_Date_Testing',
             'Hidden',
             'Stepmax',
             'Rf',
             'Until_Date',
             'N_Assets')
  Readme_ANNt[1:length(Inputs),1]=Inputs
  load('~/Tickers.rda')
  load('~/RM.rda')
  load('~/Initial_Date.rda')
  load('~/Final_Date.rda')
  #load('~/x0.rda')
  load('~/Initial_Date_Training.rda')
  load('~/Final_Date_Training.rda')
  load('~/Initial_Date_Testing.rda')
  load('~/Final_Date_Testing.rda')
  load('~/Hidden.rda')
  load('~/Stepmax.rda')
  load('~/Rf.rda')
  load('~/Until_Date.rda')
  load('~/N_Assets.rda')
  load("~/Signal_Sharpe.rda")
  if(Signal_Sharpe==1){
    RM = "SHARPE"
  }
  if(Final_Date==''){
    load('~/scenario.set.rda')
    Final_Date = rownames(as.data.frame(scenario.set)[nrow(scenario.set),])
  }
  Values=c(tickers)
  for(k in (2:length((Values)))){
  Readme_ANNt[1,k]=Values[k]
  }
  Values_inputs=c(RM,
                  Initial_Date,
                  Final_Date,
                  Initial_Date_Training,
                  Final_Date_Training,
                  Initial_Date_Testing,
                  Final_Date_Testing,
                  Hidden,
                  Stepmax,
                  Rf,
                  Until_Date,
                  N_Assets)
    for(i in (1:length((Values_inputs)))){
    Readme_ANNt[i+1,2]=Values_inputs[i]
  }
View(Readme_ANNt)

  Data = Sys.time()
  nome_dir= str_replace(Data,"-","_")
  nome_dir= str_replace(nome_dir,"-","_")
  nome_dir= str_replace(nome_dir,":","h")
  nome_dir= str_replace(nome_dir,":","m")
  nome_dir= str_replace(nome_dir,"-","_")
  nome_readme=paste("Readme_ANNt_", nome_dir, sep="")
  save(Readme_ANNt, file='~/Readme_ANNt.rda')


  nome_dir_backup=paste("~/Backup_ANNt_",nome_dir, sep="")
  dir.create(nome_dir_backup)
  files = dir('~/')[1:length(dir('~/'))]
  caminho = '~/'
  files_from = str_c(caminho,files)
  files_to = str_c(nome_dir_backup,'/',files)
  file.copy(files_from, files_to)

  Readme_ANNt_wrt = paste(nome_dir_backup,"/",nome_readme,".xlsx", sep="")
  write_xlsx(Readme_ANNt, Readme_ANNt_wrt)
}
